version: "3.8"

x-bot-config: &bot-config
  build: .
  restart: always
  shm_size: "2gb"
  env_file: .env
  deploy:
    resources:
      limits:
        memory: 600M
      reservations:
        memory: 200M

services:
  # ===================== SHEYPOOR BOTS =====================

  # 1. MAZANDARAN
  sheypoor-mazandaran:
    <<: *bot-config
    container_name: shi-mazandaran
    # ✅ مسیر صحیح: چون پوشه در روت پروژه است، مستقیم صدایش می‌زنیم
    command: node Sheypoor-MZNDRN/src/index.js
    environment:
      - PORT=4000
      - BOT_TOKEN=${TOKEN_MAZANDARAN}

  # 2. QOM - ARAK
  sheypoor-qom-arak:
    <<: *bot-config
    container_name: shi-qom-arak
    command: node Sheypoor-QOM-ARAK/src/index.js
    environment:
      - PORT=4001
      - BOT_TOKEN=${TOKEN_QOM_ARAK}

  # 3. SHIRAZ - ISFAHAN
  sheypoor-shiraz-isfahan:
    <<: *bot-config
    container_name: shi-shiraz-isfahan
    command: node Sheypoor-SHZ-ISFHN/src/index.js
    environment:
      - PORT=4002
      - BOT_TOKEN=${TOKEN_SHIRAZ_ISFAHAN}

  # 4. TEHRAN - SEMNAN
  sheypoor-tehran-semnan:
    <<: *bot-config
    container_name: shi-tehran-semnan
    command: node Sheypoor-THR-SMNAN/src/index.js
    environment:
      - PORT=4003
      - BOT_TOKEN=${TOKEN_TEHRAN_SEMNAN}

  # 5. YAZD - GILAN
  sheypoor-yazd-gilan:
    <<: *bot-config
    container_name: shi-yazd-gilan
    command: node Sheypoor-YAZD-GILAN/src/index.js
    environment:
      - PORT=4004
      - BOT_TOKEN=${TOKEN_YAZD_GILAN}
